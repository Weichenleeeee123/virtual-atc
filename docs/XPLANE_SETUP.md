# X-Plane 配置指南

## 启用 UDP 数据输出

### 步骤 1：打开 Data Output 设置
1. 启动 X-Plane
2. 点击菜单 `Settings` → `Data Output`

### 步骤 2：选择数据组
勾选以下数据组的 **UDP** 列：

| 序号 | 数据组名称 | 说明 |
|------|-----------|------|
| 3 | Speeds | 空速、地速、真空速 |
| 17 | Pitch, Roll, Heading | 俯仰、滚转、航向 |
| 20 | Lat, Lon, Alt | 纬度、经度、高度 |

### 步骤 3：配置 UDP 目标
在 `Data Output` 窗口底部：
- **IP Address**: `127.0.0.1`（本机）
- **Port**: `49000`（默认端口）

### 步骤 4：验证配置
1. 点击 `Done` 保存设置
2. 开始飞行
3. Virtual ATC 应该能够接收到数据

## 故障排查

### 问题：收不到数据
1. 确认 X-Plane 正在飞行（不是暂停状态）
2. 检查防火墙是否允许 UDP 49000 端口
3. 确认 IP 地址和端口配置正确

### 问题：数据不更新
1. 确认勾选了正确的数据组
2. 检查 UDP 列是否勾选（不是 Screen 列）
3. 重启 X-Plane 和 Virtual ATC

### 测试 UDP 连接
使用命令行工具测试：

**Windows:**
```cmd
# 安装 netcat (如果没有)
# 然后监听端口
nc -ul 49000
```

**Linux/Mac:**
```bash
nc -ul 49000
```

如果看到数据流，说明 X-Plane 正在发送数据。

## 高级配置

### 自定义端口
如果 49000 端口被占用，可以修改：
1. X-Plane 中修改 Port 设置
2. Virtual ATC 中也需要相应修改（未来版本支持）

### 网络飞行
如果 Virtual ATC 运行在另一台电脑：
1. 将 IP Address 改为 Virtual ATC 所在电脑的 IP
2. 确保两台电脑在同一网络
3. 检查防火墙设置

## 推荐设置

### 数据更新频率
- **低配电脑**: 5 Hz（每秒 5 次）
- **中配电脑**: 10 Hz（推荐）
- **高配电脑**: 20 Hz

频率越高，数据越实时，但 CPU 占用也越高。

### 最小配置
只需要以下 3 个数据组即可运行 Virtual ATC：
- 3 (Speeds)
- 17 (Pitch, Roll, Heading)
- 20 (Lat, Lon, Alt)

### 完整配置
如果需要更多功能，可以额外启用：
- 4 (Mach, VVI, G-load)
- 8 (Joystick aileron/elevator/rudder)
- 25 (Throttle actual)

## 截图参考

```
┌─────────────────────────────────────────┐
│ Data Output                              │
├─────────────────────────────────────────┤
│                                          │
│ Index  Data Set Name        Screen  UDP │
│ ─────  ─────────────────    ──────  ─── │
│   0    Frame rate            [ ]    [ ] │
│   1    Times                 [ ]    [ ] │
│   2    Sim stats             [ ]    [ ] │
│   3    Speeds                [ ]    [✓] │ ← 勾选
│   ...                                    │
│  17    Pitch, Roll, Heading  [ ]    [✓] │ ← 勾选
│   ...                                    │
│  20    Lat, Lon, Alt         [ ]    [✓] │ ← 勾选
│                                          │
├─────────────────────────────────────────┤
│ IP Address: 127.0.0.1                   │
│ Port: 49000                             │
│                                          │
│              [Done]                      │
└─────────────────────────────────────────┘
```

## 注意事项

1. **性能影响**: UDP 输出对性能影响很小，可以放心启用
2. **数据精度**: X-Plane 发送的是单精度浮点数（float32）
3. **坐标系统**: 高度是海拔高度（MSL），不是地面高度（AGL）
4. **航向**: 真航向（True Heading），不是磁航向（Magnetic Heading）

## 下一步

配置完成后，启动 Virtual ATC 并点击"连接模拟器"按钮。如果一切正常，你应该能看到：
- 连接状态变为"已连接"（绿色）
- 飞行信息实时更新
- 可以开始使用 PTT 按钮进行通话

祝飞行愉快！✈️
