# Whisper 模型管理功能

## 功能说明

Virtual ATC 内置了 Whisper 模型管理器，用户可以在软件内直接下载、管理和切换语音识别模型。

## 可用模型

| 模型 | 大小 | 速度 | 准确率 | 推荐场景 |
|------|------|------|--------|----------|
| **tiny** | 75 MB | 最快 | 较低 | 快速测试 |
| **base** | 142 MB | 快 | 一般 | 基础使用 |
| **small** | 466 MB | 中等 | 良好 | 日常使用 |
| **medium** | 1.5 GB | 较慢 | 很好 | **推荐**，中英文效果好 |
| **large-v3** | 3.1 GB | 慢 | 最佳 | 专业用途，需要强大硬件 |

## 使用方法

### 1. 打开模型管理器

在 Virtual ATC 主界面，点击"模型管理"按钮。

### 2. 下载模型

- 选择需要的模型，点击"⬇️ 下载"按钮
- 下载过程中会显示实时进度条
- 下载完成后会自动保存到本地

### 3. 加载模型

- 下载完成后，点击"📂 加载"按钮
- 加载成功后，按钮会变成"✅ 已加载"
- 只有加载后的模型才能用于语音识别

### 4. 切换模型

- 可以随时切换不同的模型
- 点击其他模型的"加载"按钮即可切换
- 建议根据硬件性能选择合适的模型

### 5. 删除模型

- 点击"🗑️ 删除"按钮可以删除已下载的模型
- 删除前会弹出确认对话框
- 删除后可以重新下载

## 模型存储位置

模型文件保存在以下位置：

**Windows:**
```
C:\Users\<用户名>\AppData\Roaming\VirtualATC\models\
```

**macOS:**
```
~/Library/Application Support/VirtualATC/models/
```

**Linux:**
```
~/.local/share/VirtualATC/models/
```

## 推荐配置

### 入门配置（8GB RAM）
- 推荐：**small** 模型
- 识别速度：2-3 秒
- 准确率：良好

### 标准配置（16GB RAM）
- 推荐：**medium** 模型
- 识别速度：3-5 秒
- 准确率：很好（中英文效果好）

### 高端配置（32GB RAM + 独显）
- 推荐：**large-v3** 模型
- 识别速度：5-8 秒
- 准确率：最佳

## 性能优化

### GPU 加速

如果你有 NVIDIA 显卡，可以启用 GPU 加速：

1. 安装 CUDA Toolkit
2. 重新编译 whisper-rs（启用 CUDA 特性）
3. 识别速度可提升 3-5 倍

### 内存优化

- 使用较小的模型（tiny/base/small）
- 关闭其他占用内存的程序
- 确保有足够的可用内存

## 常见问题

### Q: 下载速度慢怎么办？

A: 模型托管在 Hugging Face，国内访问可能较慢。建议：
- 使用科学上网工具
- 或手动下载后放到模型目录

### Q: 下载失败怎么办？

A: 可能的原因：
- 网络连接问题
- 磁盘空间不足
- 防火墙拦截

解决方法：
- 检查网络连接
- 确保有足够的磁盘空间（至少 5GB）
- 临时关闭防火墙

### Q: 模型加载失败？

A: 可能的原因：
- 模型文件损坏
- 内存不足
- 文件权限问题

解决方法：
- 删除并重新下载模型
- 关闭其他程序释放内存
- 检查文件权限

### Q: 识别准确率低？

A: 建议：
- 使用更大的模型（medium 或 large-v3）
- 确保麦克风音质良好
- 说话清晰，避免背景噪音
- 使用标准的陆空通话用语

### Q: 可以离线使用吗？

A: 可以！模型下载后会保存在本地，之后可以完全离线使用。

## 手动下载模型

如果自动下载失败，可以手动下载：

1. 访问 Hugging Face：
   ```
   https://huggingface.co/ggerganov/whisper.cpp/tree/main
   ```

2. 下载对应的模型文件：
   - `ggml-tiny.bin`
   - `ggml-base.bin`
   - `ggml-small.bin`
   - `ggml-medium.bin`
   - `ggml-large-v3.bin`

3. 将文件复制到模型目录（见上文"模型存储位置"）

4. 在软件中点击"加载"按钮

## 技术细节

### 模型格式

Virtual ATC 使用 GGML 格式的 Whisper 模型，这是一种优化的二进制格式，具有：
- 更小的文件大小
- 更快的加载速度
- 更低的内存占用

### 下载源

模型从 Hugging Face 官方仓库下载：
```
https://huggingface.co/ggerganov/whisper.cpp
```

### 完整性校验

下载完成后，软件会自动验证文件完整性，确保模型可用。

## 更新日志

### v1.0.0 (2026-02-14)
- ✅ 初始版本
- ✅ 支持 5 种模型大小
- ✅ 实时下载进度显示
- ✅ 一键加载和切换
- ✅ 模型管理（下载/删除）

## 反馈

如果遇到问题或有建议，请在 GitHub 提交 Issue：
https://github.com/Weichenleeeee123/virtual-atc/issues
